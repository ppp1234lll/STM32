/*
*********************************************************************************************************
*
*	模块名称 : MAIN函数
*	文件名称 : main.h
*	版    本 : V1.0
*	说    明 : 这是main文件包含的所有.h文件，包含调用的底层驱动、标准库等。
*			        
*	修改记录 :
*		版本号  日期         作者       说明
*		V1.0    2025-11-13    FN       正式发布
*
*	Copyright (C), 2018-2030, 蜂鸟物联网 www.armfly.com
*
*********************************************************************************************************
*/
#ifndef __MAIN_H__
#define __MAIN_H__

/*
*********************************************************************************************************
*                                         Standard Libraries
*********************************************************************************************************
*/
#include <stdbool.h>
#include "string.h"
#include "stdio.h"

/*
*********************************************************************************************************
*                                        Memory Headers
*********************************************************************************************************
*/
#include "malloc.h"

/*
*********************************************************************************************************
*                                         System Headers
*********************************************************************************************************
*/
#include "sys.h"
#include "delay.h"


/*
*********************************************************************************************************
*                                        BSP Modules
*********************************************************************************************************
*/
#include "stmflash.h" 
#include "w25qxx.h"
#include "IWDG.h"
#include "usart_debug.h"

/*
*********************************************************************************************************
*                                        APP Modules
*********************************************************************************************************
*/
#include "iap.h"

/*
*********************************************************************************************************
*                                         Utility Libraries
*********************************************************************************************************
*/
#include "crc.h"

/*
*********************************************************************************************************
*                                           Definitions
*********************************************************************************************************
*/
// 升级参数存储地址
#define UPDATA_SPIFLASH_ADDR   (3*1024*1024) // W25Q128升级文件存储地址
#define UPDATA_PARAM_ADDR      (UPDATA_SPIFLASH_ADDR + (1*1024*1024) - (1*1024)) // 系统升级参数存储地址

// APP程序入口地址
#define MAIN_APP_ADDR		    0x08010000  


/*
*********************************************************************************************************
*                                        Variable definition
*********************************************************************************************************
*/
// 升级参数
struct BOOT_UPDATE_PARAM
{
	unsigned int is_update;     // true:需要升级, false:无需升级
	unsigned int section_size;  // 每包的实际数据(去掉校验2字节)大小
	unsigned int section_count; // 总包数
};

/*
*********************************************************************************************************
*                                      Function definition
*********************************************************************************************************
*/
/* 供外部调用的函数声明 */
void system_setup_function(void);
void led_gpio_init_function(void);
void led_show_control(uint8_t mode);

#endif

/****************************************** END OF FILE **********************************************/
